(this.webpackJsonpgraphmaker=this.webpackJsonpgraphmaker||[]).push([[0],{266:function(e,t,n){},267:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(11),a=n.n(c),i=n(13),l=n(19),d=n(29),u=n(311),s=n(314),b=n(312),j=n(268),p=n(313),f=n(72),O=n.n(f),h=n(71),x=n.n(h),v=n(310),g=n(309),m=n(31),y=n(75),k=n(304),C=n(132),w=n.n(C),N=n(128),S=n.n(N),E=n(129),T=n.n(E),A=n(130),D=n.n(A),B=n(131),W=n.n(B),I=n(3);function P(e){var t=e.colorDispatchable,n=e.color,r=Object(y.a)(e,["colorDispatchable","color"]),o=Object(i.b)();return Object(I.jsx)(k.a,{style:Object(m.a)({width:30,minWidth:30,height:30,borderWidth:4,borderColor:t.colorable.color===n?"red":"black",borderStyle:"solid",margin:8,background:n},r),onClick:function(){o(t.dispatchable(n))}})}var R=function(e){var t=e.colorDispatchable,n=e.colors;return Object(I.jsx)("div",{style:{display:"flex",marginLeft:-8},children:n.map((function(e){return Object(I.jsx)(P,{colorDispatchable:t,color:e},e)}))})},_=n(137),J=n(74),L=n(32),U=function(e){return Math.max.apply(Math,Object(_.a)(e.map((function(e){return e.id})).concat([0])||0))+1},F=Object(J.b)({name:"graph",initialState:{nodes:[{id:1,label:"Node 1",color:"red",shape:"box"},{id:2,label:"Node 2",color:"white",shape:"box"},{id:3,label:"Node 3",color:"white",shape:"box"},{id:4,label:"Node 4",color:"white",shape:"box"},{id:5,label:"Node 5",color:"white",shape:"box"}],edges:[{id:1,from:1,to:2,color:"black"},{id:2,from:1,to:3,color:"black"},{id:3,from:2,to:4,color:"black"},{id:4,from:2,to:5,color:"black"}],text:"# Hello world\n"},reducers:{addNode:{reducer:function(e,t){e.nodes.push({id:U(e.nodes),label:t.payload.label,shape:"box",color:"white"})},prepare:function(e){return{id:Object(L.a)(),payload:e}}},addEdge:{reducer:function(e,t){e.edges.push({id:U(e.edges),from:t.payload.from.id,to:t.payload.to.id,color:"black"})},prepare:function(e){return{id:Object(L.a)(),payload:e}}},setNodeColor:{reducer:function(e,t){var n=e.nodes.find((function(e){return e.id===t.payload.node.id}));n&&(n.color=t.payload.color)},prepare:function(e){return{id:Object(L.a)(),payload:e}}},setNodeShape:{reducer:function(e,t){var n=e.nodes.find((function(e){return e.id===t.payload.node.id}));n&&(n.shape=t.payload.shape)},prepare:function(e){return{id:Object(L.a)(),payload:e}}},setEdgeColor:{reducer:function(e,t){var n=e.edges.find((function(e){return e.id===t.payload.edge.id}));n&&(n.color=t.payload.color)},prepare:function(e){return{id:Object(L.a)(),payload:e}}},deleteNode:{reducer:function(e,t){e.nodes=e.nodes.filter((function(e){return e.id!==t.payload.id})),e.edges=e.edges.filter((function(e){return e.from!==t.payload.id&&e.to!==t.payload.id}))},prepare:function(e){return{id:Object(L.a)(),payload:e}}},setGraph:{reducer:function(e,t){e.nodes=t.payload.nodes,e.edges=t.payload.edges},prepare:function(e){return{id:Object(L.a)(),payload:e}}},updateText:{reducer:function(e,t){e.text=t.payload},prepare:function(e){return{id:Object(L.a)(),payload:e}}}}}),G=F.actions,M=G.addNode,z=G.addEdge,H=G.setNodeColor,q=G.setNodeShape,K=G.setEdgeColor,Q=G.deleteNode,V=G.setGraph,X=G.updateText,Y=F.reducer;function Z(e){var t=e.node,n=e.shape,r=Object(y.a)(e,["node","shape"]),o=Object(i.b)();return Object(I.jsx)(k.a,{style:Object(m.a)({width:30,minWidth:30,height:30,margin:8,color:n===t.shape?"blue":"black"},r),onClick:function(){o(q({node:t,shape:n}))},children:{star:Object(I.jsx)(S.a,{}),box:Object(I.jsx)(T.a,{}),ellipsis:Object(I.jsx)(D.a,{}),triangle:Object(I.jsx)(W.a,{})}[n]})}var $=["star","box","ellipsis","triangle"];function ee(e){var t=e.node;return Object(I.jsx)("div",{style:{display:"flex",marginLeft:-8},children:$.map((function(e){return Object(I.jsx)(Z,{node:t,shape:e},e)}))})}var te=function(e){var t=e.node,n=e.index,o=Object(i.b)(),c=Object(r.useRef)(null);return Object(d.a)((1+n).toString(),(function(){var e;null===c||void 0===c||null===(e=c.current)||void 0===e||e.getElementsByTagName("button")[0].focus()})),Object(I.jsxs)("li",{style:{listStyleType:"none",margin:0},ref:c,children:[" ",t.label,Object(I.jsxs)("div",{style:{display:"flex"},children:[Object(I.jsxs)("div",{children:[Object(I.jsx)(R,{colorDispatchable:{colorable:t,dispatchable:function(e){return H({node:t,color:e})}},colors:["white","red","blue","yellow"]}),Object(I.jsx)(ee,{node:t})]}),Object(I.jsx)("div",{children:Object(I.jsx)(k.a,{style:{padding:22,minWidth:0,width:24,height:24},onClick:function(){return o(Q(t))},children:Object(I.jsx)(w.a,{})})})]})]})};var ne=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.graph})),n=Object(r.useState)(""),o=Object(l.a)(n,2),c=o[0],a=o[1],u=Object(r.useState)(""),s=Object(l.a)(u,2),b=s[0],f=s[1],h=Object(r.useRef)(null),m=Object(r.useRef)(null);return Object(d.a)("esc",(function(){var e=document.activeElement;if(e){var t=e.value;e.value="",e.blur(),e.value=t}}),{enableOnTags:["INPUT"]}),Object(d.a)("a",(function(){var e;return null===h||void 0===h||null===(e=h.current)||void 0===e?void 0:e.focus()}),{keyup:!0}),Object(d.a)("s",(function(){var e;return null===m||void 0===m||null===(e=m.current)||void 0===e?void 0:e.focus()}),{keyup:!0}),Object(I.jsxs)("div",{children:[Object(I.jsx)(j.a,{variant:"h5",component:"h2",gutterBottom:!0,children:"Nodos"}),Object(I.jsx)(p.a,{fullWidth:!0,label:"Buscar",inputProps:{"aria-label":"Buscar",ref:m},InputProps:{endAdornment:Object(I.jsxs)(g.a,{position:"end",children:[c&&Object(I.jsx)(v.a,{onClick:function(){return a("")},children:Object(I.jsx)(x.a,{})}),!c&&Object(I.jsx)(v.a,{onClick:function(){},children:Object(I.jsx)(O.a,{})})]})}}),Object(I.jsx)(p.a,{fullWidth:!0,label:"Agregar nodo...",onBlur:function(t){var n=t.target.value;n&&(e(M({label:n,color:"white"})),f(""))},value:b,inputProps:{ref:h},onChange:function(e){return f(e.target.value)},onKeyPress:function(e){return"Enter"===e.key&&e.target.blur()}}),Object(I.jsx)("ul",{style:{padding:0},children:t.nodes.map((function(e,t){return Object(I.jsx)(te,{index:t,node:e},e.id)}))})]})},re=n(315);var oe=function(e){var t=e.edge,n=e.from,r=e.to;return Object(I.jsxs)("li",{style:{listStyleType:"none",margin:0},children:[n.label," - ",r.label,Object(I.jsx)(R,{colorDispatchable:{colorable:t,dispatchable:function(e){return K({edge:t,color:e})}},colors:["black","red","blue","yellow"]})]})};var ce=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.graph.edges})),n=Object(i.c)((function(e){return e.graph.nodes})),o=Object.fromEntries(n.map((function(e){return[e.id,e]}))),c=Object(r.useState)(""),a=Object(l.a)(c,2),d=a[0],u=a[1],s=Object(r.useState)(null),b=Object(l.a)(s,2),f=b[0],h=b[1],y=Object(r.useState)(null),k=Object(l.a)(y,2),C=k[0],w=k[1];return Object(r.useEffect)((function(){f&&C&&(e(z({from:f,to:C})),h(null),w(null))}),[h,w,f,C,e]),Object(I.jsxs)("div",{children:[Object(I.jsx)(j.a,{variant:"h5",component:"h2",gutterBottom:!0,children:"Conectores"}),Object(I.jsx)(p.a,{fullWidth:!0,label:"Buscar",inputProps:{"aria-label":"Buscar"},InputProps:{endAdornment:Object(I.jsxs)(g.a,{position:"end",children:[d&&Object(I.jsx)(v.a,{onClick:function(){return u("")},children:Object(I.jsx)(x.a,{})}),!d&&Object(I.jsx)(v.a,{onClick:function(){},children:Object(I.jsx)(O.a,{})})]})}}),Object(I.jsx)(re.a,{options:n,getOptionLabel:function(e){return e.label},onChange:function(e,t){return h(t)},value:f,blurOnSelect:!0,renderInput:function(e){return Object(I.jsx)(p.a,Object(m.a)(Object(m.a)({},e),{},{fullWidth:!0,label:"Agregar conector desde..."}))}}),Object(I.jsx)(re.a,{options:n,getOptionLabel:function(e){return e.label},blurOnSelect:!0,onChange:function(e,t){return w(t)},value:C,renderInput:function(e){return Object(I.jsx)(p.a,Object(m.a)(Object(m.a)({},e),{},{fullWidth:!0,label:"Agregar conector hacia..."}))}}),Object(I.jsx)("ul",{style:{padding:0},children:t.map((function(e){return Object(I.jsx)(oe,{edge:e,from:o[e.from],to:o[e.to]},e.id)}))})]})};var ae=function(){var e=Object(i.c)((function(e){return e.graph.text})),t=Object(i.b)(),n=Object(r.useRef)();return Object(r.useEffect)((function(){var e;null===n||void 0===n||null===(e=n.current)||void 0===e||e.focus()})),Object(I.jsx)("div",{children:Object(I.jsx)(p.a,{multiline:!0,fullWidth:!0,inputProps:{style:{minHeight:400}},inputRef:n,value:e,onChange:function(e){return t(X(e.target.value))}})})};var ie=function(e){var t=e.tab;return Object(I.jsx)("div",{style:{height:"100vh",overflow:"auto"},children:Object(I.jsxs)("div",{style:{padding:20},children:[Object(I.jsx)("div",{hidden:0!==t,children:Object(I.jsx)(ne,{})}),Object(I.jsx)("div",{hidden:1!==t,children:Object(I.jsx)(ce,{})}),Object(I.jsx)("div",{hidden:2!==t,children:Object(I.jsx)(ae,{})})]})})},le=n(134),de=n.n(le),ue=n(135),se=n(136),be=n.n(se);var je=function(e){var t=e.tab,n=Object(i.c)((function(e){return e.graph})),o=Object(r.useState)("0"),c=Object(l.a)(o,2),a=c[0],d=c[1],u=Object(r.useState)(null),s=Object(l.a)(u,2),b=s[0],j=s[1],p=Object(r.useState)(""),f=Object(l.a)(p,2),O=f[0],h=f[1],x=Object(r.useState)(null),v=Object(l.a)(x,2),g=v[0],m=v[1],y=Object(i.b)(),C=Object(i.c)((function(e){return e.graph.text}));Object(r.useEffect)((function(){var e=JSON.stringify(n);if(e!==O&&(h(e),j(JSON.parse(e)),d((parseInt(a)+1).toString())),console.log(n),g){var t=g,r=n.nodes,o=n.nodes.map((function(e){return e.id})),c=JSON.parse(O).nodes.filter((function(e){return-1===o.indexOf(e.id)}));t.body.data.nodes.remove(c),t.body.data.nodes.update(r);var i=n.edges.map((function(e){return e.id})),l=JSON.parse(O).edges.filter((function(e){return-1===i.indexOf(e.id)}));t.body.data.edges.remove(l),t.body.data.edges.update(n.edges),t.stabilize(1e3)}}),[h,n,O,a,g]);var w=Object(r.useRef)(null);return Object(r.useEffect)((function(){g||m(w.current&&b&&new ue.Network(w.current,b,{physics:{enabled:!1},edges:{arrows:{to:{enabled:!0}}}}))}),[w,b,g]),Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{style:{position:"absolute",top:0,right:0,background:"white",zIndex:1},children:[Object(I.jsx)(k.a,{onClick:function(){var e=document.createElement("input");e.setAttribute("type","file"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),e.onchange=function(){var t=e.files[0],n=function(e,t){var n;return null===(n=t.find((function(t){return t.id===e})))||void 0===n?void 0:n.eq},r=new FileReader;r.onload=function(e){var t=e.target.result,r=be()(t);console.log(r);var o=r[0].children.filter((function(e){return"node_stmt"===e.type})).map((function(e,t){return e})).map((function(e,t){return{id:t+1,label:e.node_id.id,color:n("color",e.attr_list),shape:n("shape",e.attr_list)}})),c=Object.fromEntries(o.map((function(e){return[e.label,e]}))),a=r[0].children.filter((function(e){return"edge_stmt"===e.type})).map((function(e,t){return e})).map((function(e,t){return{id:t+1,from:c[e.edge_list[0].id].id,to:c[e.edge_list[1].id].id,color:n("color",e.attr_list)}}));y(V({nodes:o,edges:a}))},r.readAsText(t,"UTF-8")}},children:"Upload DOT"}),Object(I.jsx)(k.a,{onClick:function(){var e=Object.fromEntries(n.nodes.map((function(e){return[e.id,e]}))),t="digraph {\n";t+=n.nodes.map((function(e){return'  "'.concat(e.label,'"[shape=').concat(e.shape,"][color=").concat(e.color,"]")})).join("\n")+"\n",t+=n.edges.map((function(t){return'  "'.concat(e[t.from].label,'"->"').concat(e[t.to].label,'"[color=').concat(t.color,"]")})).join("\n")+"\n",t+="}";var r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),r.setAttribute("download","graph.dot"),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)},children:"Download as DOT"}),Object(I.jsx)(k.a,{onClick:function(){var e,t=null===w||void 0===w||null===(e=w.current)||void 0===e?void 0:e.getElementsByTagName("canvas")[0];if(t){var n=t.toDataURL().replace(/^data:image\/[^;]/,"data:application/octet-stream"),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download","graph.png"),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},children:"Download as PNG"})]}),Object(I.jsx)("div",{ref:w,style:{width:"100%",height:"100vh",display:1===t||0===t?"block":"none"}}),Object(I.jsx)("div",{style:{width:"100%",height:"100vh",display:2===t?"block":"none"},children:Object(I.jsx)(de.a,{children:C})})]})};var pe=function(){var e=Object(r.useState)(0),t=Object(l.a)(e,2),n=t[0],o=t[1];return Object(d.a)("ctrl+1",(function(){return o(0)})),Object(d.a)("ctrl+2",(function(){return o(1)})),Object(d.a)("ctrl+3",(function(){return o(2)})),Object(I.jsxs)("div",{children:[Object(I.jsx)(u.a,{position:"static",children:Object(I.jsxs)(s.a,{value:n,onChange:function(e,t){return o(t)},children:[Object(I.jsx)(b.a,{label:"Nodos"}),Object(I.jsx)(b.a,{label:"Conectores"}),Object(I.jsx)(b.a,{label:"Texto libre"})]})}),Object(I.jsxs)("div",{className:"App",style:{display:"flex"},children:[Object(I.jsx)("div",{style:{flex:1},children:Object(I.jsx)(ie,{tab:n})}),Object(I.jsx)("div",{style:{flex:1},children:Object(I.jsx)(je,{tab:n})})]})]})},fe=n(22),Oe=Object(J.a)({reducer:Object(fe.b)({graph:Y})});n(266);a.a.render(Object(I.jsx)(o.a.StrictMode,{children:Object(I.jsx)(i.a,{store:Oe,children:Object(I.jsx)(pe,{})})}),document.getElementById("root"))}},[[267,1,2]]]);
//# sourceMappingURL=main.41365060.chunk.js.map